

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Create Simulations in Python &mdash; DynaMind 0.7 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="DynaMind 0.7 documentation" href="../index.html"/>
        <link rel="up" title="DynaMind Core" href="index.html"/>
        <link rel="next" title="Sim" href="dynamind_sim_api.html"/>
        <link rel="prev" title="Module Development" href="module.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../index.html" class="fa fa-home"> DynaMind</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../quick-intro-gui.html">A Quick Introduction to the DynaMind GUI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quick-intro-gui.html#the-problem">The Problem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-intro-gui.html#building-a-workflow">Building a workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-intro-gui.html#executing-a-workflow">Executing a Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quick-intro-gui.html#solution">Solution</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../known_problems.html">Known Issues</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../known_problems.html#gdal-python-modules">GDAL Python Modules</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">DynaMind Core</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="module.html">Module Development</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Create Simulations in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-use-cases">Advanced Use Cases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#dynamind-core-api">DynaMind Core API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dynamind_sim_api.html">Sim</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamind_sim_api.html#module">Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamind_sim_api.html#viewcontainer">ViewContainer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../DynaMind-GDALModules/index.html">Standard Modules (GDAL)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/overview.html">Module List</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalerase.html">Subtract Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalhotstarter.html">Hot Start Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalimportdata.html">Import GIS Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalpublishresults.html">Export GIS data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalspatiallinking.html">Spatially Link Data Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/nonspatiallinking.html">Link Data Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalparcelsplit.html">Subdivide Parcels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalcalculatecentroids.html">Create Centroids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalparceling.html">Parcel Faces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdaloffset.html">Offset Faces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalcopyelementtoview.html">Copy Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdaljoinnearestneighbour.html">Link Nearest Neighbour</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalattributecalculator.html">Calculate Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalgeometricattributes.html">Calculate Area</a></li>
<li class="toctree-l2"><a class="reference internal" href="../DynaMind-GDALModules/gdalcreatebuilding.html">Generate Simple Buildings</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">DynaMind</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">DynaMind Core</a> &raquo;</li>
      
    <li>Create Simulations in Python</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../_sources/DynaMind/simulations_python.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="create-simulations-in-python">
<h1>Create Simulations in Python<a class="headerlink" href="#create-simulations-in-python" title="Permalink to this headline">¶</a></h1>
<p>DynaMind provides a Python interface to set up complex a workflow.
The following document gives a step by step overview of the most important interfaces.</p>
<div class="section" id="initialising-a-new-simulation">
<h2>Initialising a New Simulation<a class="headerlink" href="#initialising-a-new-simulation" title="Permalink to this headline">¶</a></h2>
<p>To create a new simulation import pydynamind in your Python script and create a new simulation
instance of the <code class="docutils literal"><span class="pre">Sim</span></code> class (see following listing). This creates an DynaMind simulation.</p>
<p>Before modules can be added to the simulation modules may be registered using with calling
<code class="docutils literal"><span class="pre">register_modules(&quot;Module</span> <span class="pre">Path&quot;)</span></code>. DynaMind registers modules from all libraries found in the specified
folder (Native or Python).</p>
<p>The last step to initialise a simulations requires to define the spatial reference used for the simulation calling
<code class="docutils literal"><span class="pre">set_epsg_code(EPSG</span> <span class="pre">Code)</span></code>. A full list of EPSG codes can be found <a class="reference external" href="http://spatialreference.org">here</a>. Setting
the EPSG code is crucial otherwise the GIS database can not be correctly initialise which can
make simulations painfully slow.</p>
<p>After registering modules and defining a spatial reference the DynaMind simulation is ready.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Import DynaMind Python interface</span>
<span class="kn">import</span> <span class="nn">pydynamind</span> <span class="kn">as</span> <span class="nn">DM</span>

<span class="c"># Create a new simulation</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">DM</span><span class="o">.</span><span class="n">Sim</span><span class="p">()</span>

<span class="c"># Register modules from folder</span>
<span class="n">sim</span><span class="o">.</span><span class="n">register_modules</span><span class="p">(</span><span class="s">&quot;Modules&quot;</span><span class="p">)</span>

<span class="c"># Set EPSG code for the simulation. This is crucial, otherwise the GIS backend of the</span>
<span class="c"># simulation database is disabled which makes simulations painfully slow</span>
<span class="c"># EPSG 32755 : WGS 84/UTM zone 55S (works well for Melbourne)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_epsg_code</span><span class="p">(</span><span class="mi">32755</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-modules">
<h2>Adding Modules<a class="headerlink" href="#adding-modules" title="Permalink to this headline">¶</a></h2>
<p>To add modules call the <code class="docutils literal"><span class="pre">add_module(class_name,</span> <span class="pre">parameter={},</span> <span class="pre">connect_module=None,</span> <span class="pre">parent_group=None,</span> <span class="pre">filters={},</span> <span class="pre">module_name=&quot;&quot;)</span></code> function of the initialised simulation.
This functions adds a new module to the simulation and returns the generated module. The returned module can be used to link the module later to another module.</p>
<p>Parameter:</p>
<blockquote>
<div><ul class="simple">
<li>class_name: The class name of the to add module. A list of available modules can be found in the documentation. In the example below the GDALImportData is loaded to import data into the simulation</li>
<li>parameter: A dictionary to set module parameter. The dictionary uses as key the parameter name and as value the parameter value e.g. <code class="docutils literal"><span class="pre">{'parameter1':</span> <span class="pre">10}</span></code>. The list of parameter for a module can be found in its documentation</li>
<li>connect_module: The newly created module is connected to the connect_module</li>
<li>parent_group: This is used to add the module to a group</li>
<li>filters: A dict of filters. <code class="docutils literal"><span class="pre">{</span> <span class="pre">view_name</span> <span class="pre">:</span> <span class="pre">{'attribute':</span> <span class="pre">'attribute</span> <span class="pre">filter'</span> <span class="pre">:</span>&nbsp; <span class="pre">spatial:</span> <span class="pre">'view</span> <span class="pre">name'}</span> <span class="pre">}</span></code></li>
<li>module_name: per default the module name is a randomly set; module_name can be used to define a specific name.</li>
</ul>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Load data from PostGIS database with GDALImport Data. Per default the module has no import</span>
<span class="n">catchment</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span><span class="s">&#39;GDALImportData&#39;</span><span class="p">,{</span><span class="s">&#39;source&#39;</span><span class="p">:</span> <span class="s">&#39;PG:dbname=elwood host=localhost port=5432 user=user password=password&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;layer_name&#39;</span><span class="p">:</span> <span class="s">&#39;elwood_catchment&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;view_name&#39;</span><span class="p">:</span> <span class="s">&#39;catchment&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;epsg_from&#39;</span><span class="p">:</span> <span class="mi">4283</span><span class="p">,</span>
                                      <span class="s">&#39;epsg_to&#39;</span><span class="p">:</span> <span class="mi">32755</span><span class="p">,</span>
                                      <span class="s">&#39;append&#39;</span> <span class="p">:</span> <span class="bp">False</span><span class="p">})</span>

<span class="c"># load land use data with the attribute lu_desc = &#39;Road Void&#39; and that are within the catchment.</span>
<span class="c"># the parameter append is set to true to allow to connect the module to the catchment module created before</span>
<span class="n">land_use</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span><span class="s">&#39;GDALImportData&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s">&#39;source&#39;</span><span class="p">:</span> <span class="s">&#39;PG:dbname=melbourne host=localhost port=5432 user=user password=password&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;layer_name&#39;</span><span class="p">:</span> <span class="s">&#39;landuse_victoria&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;view_name&#39;</span><span class="p">:</span> <span class="s">&#39;landuse&#39;</span><span class="p">,</span>
                                      <span class="s">&#39;epsg_from&#39;</span><span class="p">:</span> <span class="mi">4283</span><span class="p">,</span>
                                      <span class="s">&#39;epsg_to&#39;</span><span class="p">:</span> <span class="mi">32755</span><span class="p">,</span>
                                      <span class="s">&#39;append&#39;</span> <span class="p">:</span> <span class="bp">True</span><span class="p">},</span>
                         <span class="n">catchment</span><span class="p">,</span>
                         <span class="n">filters</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;landuse&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;attribute&#39;</span><span class="p">:</span> <span class="s">&quot;lu_desc = &#39;Road Void&#39;&quot;</span><span class="p">,</span>
                                              <span class="s">&#39;spatial&#39;</span><span class="p">:</span> <span class="s">&quot;catchment&quot;</span><span class="p">}</span>
                         <span class="p">})</span>
<span class="c"># Upload results to PostGIS database</span>
<span class="n">export</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">add_module</span><span class="p">(</span><span class="s">&#39;GDALPublishResults&#39;</span><span class="p">,</span>
                           <span class="p">{</span><span class="s">&#39;sink&#39;</span><span class="p">:</span> <span class="s">&#39;PG:dbname=melbourne host=localhost port=5432 user=user password=password&#39;</span><span class="p">,</span>
                            <span class="s">&#39;driver_name&#39;</span><span class="p">:</span> <span class="s">&#39;&#39;</span><span class="p">,</span>
                            <span class="s">&#39;targetEPSG&#39;</span> <span class="p">:</span> <span class="s">&#39;4283&#39;</span><span class="p">,</span>
                            <span class="s">&#39;sourceEPSG&#39;</span> <span class="p">:</span> <span class="s">&#39;32755&#39;</span><span class="p">,</span>
                            <span class="s">&#39;view_name&#39;</span><span class="p">:</span> <span class="s">&#39;catchment&#39;</span><span class="p">,</span>
                            <span class="s">&#39;layer_name&#39;</span><span class="p">:</span> <span class="s">&#39;result_catchment&#39;</span><span class="p">},</span>
                         <span class="n">land_use</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="execute-simulation">
<h2>Execute Simulation<a class="headerlink" href="#execute-simulation" title="Permalink to this headline">¶</a></h2>
<p>After adding and linking the modules the simulation can be executed calling the <code class="docutils literal"><span class="pre">run()</span></code> method.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Execute simulation</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="advanced-use-cases">
<h1>Advanced Use Cases<a class="headerlink" href="#advanced-use-cases" title="Permalink to this headline">¶</a></h1>
<div class="section" id="access-gdal-database">
<h2>Access GDAL Database<a class="headerlink" href="#access-gdal-database" title="Permalink to this headline">¶</a></h2>
<p>The simulation object is a complete DynaMind simulation. This means that when a simulation has been executed the simulation
still holds the calculate data until the simulation is destroyed. This allows the data to be accessed within the Python
script. To do this data (or the name of the database) can be retrieved from the last module in the simulation using <cite>getGDALDBName()</cite></p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># load land use data with the attribute lu_desc = &#39;Road Void&#39; and that are within the catchment.</span>
<span class="c"># the parameter append is set to true to allow to connect the module to the catchment module created before</span>
<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="c">#return db name from last module</span>
<span class="n">last_module</span><span class="o">.</span><span class="n">getGDALDBName</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dynamind_sim_api.html" class="btn btn-neutral float-right" title="Sim">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="module.html" class="btn btn-neutral" title="Module Development"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2015, Christian Urich, Michael Mair.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.7',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>